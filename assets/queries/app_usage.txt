SELECT
  DATETIME(ZOBJECT.ZSTARTDATE + 978307200, 'UNIXEPOCH') AS 'START',
  DATETIME(ZOBJECT.ZENDDATE + 978307200, 'UNIXEPOCH') AS 'END',
  ZOBJECT.ZVALUESTRING AS 'BUNDLE ID',
  (ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) AS 'USAGE IN SECONDS',
  (ZOBJECT.ZENDDATE - ZOBJECT.ZSTARTDATE) / 60.00 AS 'USAGE IN MINUTES',
  ZSOURCE.ZDEVICEID AS 'DEVICE ID (HARDWARE UUID)',
  ZCUSTOMMETADATA.ZNAME AS 'NAME',
  ZCUSTOMMETADATA.ZDOUBLEVALUE AS 'VALUE',
  CASE ZOBJECT.ZSTARTDAYOFWEEK
    WHEN '1' THEN 'Sunday'
    WHEN '2' THEN 'Monday'
    WHEN '3' THEN 'Tuesday'
    WHEN '4' THEN 'Wednesday'
    WHEN '5' THEN 'Thursday'
    WHEN '6' THEN 'Friday'
    WHEN '7' THEN 'Saturday'
  END AS 'DAY OF WEEK',
  ZOBJECT.ZSECONDSFROMGMT / 3600 AS 'GMT OFFSET',
  DATETIME(ZOBJECT.ZCREATIONDATE + 978307200, 'UNIXEPOCH') AS 'ENTRY CREATION',
  ZOBJECT.ZUUID AS 'UUID',
  ZSTRUCTUREDMETADATA.ZMETADATAHASH,
  ZOBJECT.Z_PK AS 'ZOBJECT TABLE ID'
FROM ZOBJECT
  LEFT JOIN ZSTRUCTUREDMETADATA
    ON ZOBJECT.ZSTRUCTUREDMETADATA = ZSTRUCTUREDMETADATA.Z_PK
  LEFT JOIN ZSOURCE
    ON ZOBJECT.ZSOURCE = ZSOURCE.Z_PK
  LEFT JOIN Z_4EVENT
    ON ZOBJECT.Z_PK = Z_4EVENT.Z_11EVENT
  LEFT JOIN ZCUSTOMMETADATA
    ON Z_4EVENT.Z_4CUSTOMMETADATA = ZCUSTOMMETADATA.Z_PK
WHERE ZSTREAMNAME = '/app/usage'
ORDER BY START DESC;